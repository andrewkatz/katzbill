.panel.panel-default
  .panel-body
    - if @items.empty?
      %p.bills You have no bills or paychecks.
    - else
      .bills
        - @items.group_by { |b| (b.try(:due_date) || b.try(:pay_date)).month }.each do |month, items|
          .row
            .col-md-12
              - if month == DateTime.now.month
                %h4 This month
              - else
                %h4= Date::MONTHNAMES[month]
          - items.each do |item|
            .row
              .col-md-12
                - if item.is_a? Bill
                  = form_for item, url: pay_bill_path(item), method: :post do |f|
                    .btn-group.hidden-xs.bill
                      = link_to item, method: :delete, class: 'btn btn-default', data: { confirm: 'Are you sure?' } do
                        %span.glyphicon.glyphicon-trash
                      = link_to item.pay_url, class: 'btn btn-default', target: '_blank', disabled: item.pay_url.blank? do
                        %span.glyphicon.glyphicon-new-window
                      = f.submit 'Pay', class: 'btn btn-primary pay'

                    .name
                      %strong= item.name
                    .due= item.due_date.strftime('%B %-d')
                    .days-left= item.days_left

                    .row.visible-xs.bill
                      .col-xs-4
                        = link_to item, method: :delete, class: 'btn btn-default btn-block', data: { confirm: 'Are you sure?' } do
                          %span.glyphicon.glyphicon-trash
                      .col-xs-4
                        = link_to item.pay_url, class: 'btn btn-default btn-block', target: '_blank', disabled: item.pay_url.blank? do
                          %span.glyphicon.glyphicon-new-window
                      .col-xs-4
                        = f.submit 'Pay', class: 'btn btn-primary pay btn-block'
                - else
                  = form_for item, url: pay_paycheck_path(item), method: :post do |f|
                    .btn-group.hidden-xs.bill
                      = link_to item, method: :delete, class: 'btn btn-default', data: { confirm: 'Are you sure?' } do
                        %span.glyphicon.glyphicon-trash
                      = f.submit 'Paid', class: 'btn btn-success pay'

                    .name
                      %strong= item.name
                    .due= item.pay_date.strftime('%B %-d')
                    .days-left= item.days_left

                    .row.visible-xs.bill
                      .col-xs-4
                        = link_to item, method: :delete, class: 'btn btn-default btn-block', data: { confirm: 'Are you sure?' } do
                          %span.glyphicon.glyphicon-trash
                      .col-xs-4
                        = f.submit 'Pay', class: 'btn btn-success pay btn-block'
